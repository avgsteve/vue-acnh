import{T as e,L as t,_ as a,C as r,D as s}from"./index.d949991f.js";import{m as o,J as l,K as d,M as n,L as i,D as c,e as u,G as p,I as g,F as m,V as _,H as h,E as C,b as f,r as T,w as x,s as y,v as S}from"./vendor.a945b803.js";import{_ as v}from"./AddToListBtn.2654b5d5.js";const b=o({name:"Preloader",components:{},setup:()=>{},props:{prop_isLoading:{type:Boolean,default:!0}},data:()=>({dataObj:null}),computed:{},watch:{},created(){},mounted(){},unmounted(){},methods:{}}),E=g();l("data-v-6deaffc6");const $={key:0,class:"loadingContainer"},L={class:"loadingContainer__background"},F=u("p",{class:"loadingText"},"Loading ",-1);d();const w=E(((e,t,a,r,s,o)=>{const l=n("van-loading");return e.prop_isLoading?(i(),c("div",$,[u("div",L,[e.prop_isLoading?(i(),c(l,{key:0,class:"loader",color:"#dfdfdf",size:"48px",vertical:"",type:"spinner"},{default:E((()=>[F])),_:1})):p("",!0)])])):p("",!0)}));b.render=w,b.__scopeId="data-v-6deaffc6";const A=o({name:"CreaturePageTabs",components:{},setup:()=>{},props:{prop1:{type:Number},prop_categories:{type:Array}},data:()=>({dataObj:null}),computed:{},watch:{},created(){},mounted(){},unmounted(){},methods:{categoryClicked(e){this.$emit("categoryClicked",e)}}}),I=g(),V=I(((e,t,a,r,s,o)=>{const l=n("van-tab"),d=n("van-tabs");return i(),c(d,{onClick:t[1]||(t[1]=t=>e.categoryClicked(t))},{default:I((()=>[(i(!0),c(m,null,_(e.prop_categories,((t,a)=>(i(),c(l,{key:a,title:e.$t(`creatures.categories.${t}`),name:t},{default:I((()=>[h(e.$slots,"default",{},void 0,!0)])),_:2},1032,["title","name"])))),128))])),_:1})}));A.render=V,A.__scopeId="data-v-2ac68e69";const D=o({name:"CreaturesFlexboxViewControl",components:{},setup:()=>{},props:{prop1:{type:Number},prop2:{type:String}},data:()=>({scaleValue:100,filterText:"",delayedEmitTimer:""}),computed:{},watch:{filterText(){clearTimeout(this.delayedEmitTimer);const e=this.filterText,t=document.querySelector("#filterInputField");e&&t.classList.add("active"),e||t.classList.remove("active");const a=setTimeout((()=>{console.log("emit!: ",e),this.$emit("filterTextChanged",e)}),500);this.delayedEmitTimer=a}},created(){},mounted(){},unmounted(){},methods:{onScaleValueChanged(t){e("目前縮放比例:"+t+"%"),this.$emit("scaleValueChanged",t)},onFocus(e){console.log("eventObj: ",e);document.querySelector("#filterInputField").classList.add("active")},onBlur(e){console.log("not focused");const t=document.querySelector("#filterInputField");this.filterText||t.classList.remove("active")}}}),R=g();l("data-v-7750428e");const k={id:"displayControl"},O={class:"displayControl__box displayFilter"},B={class:"displayControl__box sizeScaleSlider__container"},N={class:"sliderText"};d();const P=R(((e,t,a,r,s,o)=>{const l=n("van-field"),d=n("van-slider");return i(),c("div",k,[u("div",O,[u(l,{id:"filterInputField",class:"override",modelValue:e.filterText,"onUpdate:modelValue":t[1]||(t[1]=t=>e.filterText=t),center:"",clearable:"",label:e.$t("searchBar.filter"),placeholder:"Enter filter",onFocus:e.onFocus,onBlur:e.onBlur},null,8,["modelValue","label","onFocus","onBlur"])]),u("div",B,[u("p",N,C(e.$t("searchBar.scaleSlider")),1),u("div",null,[u(d,{class:"sizeScaleSlider",modelValue:e.scaleValue,"onUpdate:modelValue":t[2]||(t[2]=t=>e.scaleValue=t),onChange:e.onScaleValueChanged,max:200,min:50},null,8,["modelValue","onChange"])])])])}));D.render=P,D.__scopeId="data-v-7750428e";const j=o({name:"creaturesFlexboxView",components:{CreaturesFlexboxViewControl:D,AddToListBtn:v},setup(){const e=f(100),t=e.value/100;let a=T({margin:`${8*t}px ${10*t}px ${6*t}px`,transform:"scale(1.1)"}),r=T({width:7*t+"rem",padding:` ${.5*t}rem`});return x(e,((e,t)=>{let s=e/100;a.margin=`${8*s}px ${10*s}px ${6*s}px`,r.width=7*s+"rem",r.padding=.5*s+"rem"})),{scaleValue:e,changeScaleHandler:t=>{e.value=t},flexboxStyle:a,flexboxImageStyle:r}},props:{prop_selectedCreatureData:{type:Array,required:!1,default:[]},prop_tagsData:{type:Array,required:!1,default:[]}},data:()=>({filterText:""}),computed:{computed_filteredCreatureData(){const e=this.$store.getters[`languageSetting/${t.GET_TRANSLATION_DATA_FOR_CREATURES}`];let a=Array.from(this.prop_selectedCreatureData);for(let t=0;t<a.length;t++){const r=a[t],s=e[r.name.split("'").join("")];r.stringForFilter=s}return a=a.filter((e=>e.stringForFilter.includes(this.filterText))),a}},watch:{filterText(e){}},created(){},mounted(){},unmounted(){},methods:{setTag(e,t){document.querySelectorAll(".creaturesData__box ").forEach((e=>e.classList.remove("active"))),t.target.parentElement.classList.add("active"),this.$emit("creatureSelected",e)},changeFilterTextHandler(e){this.filterText=e}}}),U=g();l("data-v-d10f0364");const H=u("hr",null,null,-1),q=u("h4",{class:"tagSectionHeading"}," Step 2. 點選圖片查看資料: ",-1),G={id:"creaturesData"},M={class:"creaturesData__flexContainer"},z={class:"creatureName"},Q=u("br",null,null,-1);d();const J=U(((e,t,a,r,s,o)=>{const l=n("CreaturesFlexboxViewControl"),d=n("AddToListBtn");return y((i(),c("div",null,[H,q,u(l,{onScaleValueChanged:e.changeScaleHandler,onFilterTextChanged:e.changeFilterTextHandler},null,8,["onScaleValueChanged","onFilterTextChanged"]),u("div",G,[u("div",M,[(i(!0),c(m,null,_(e.computed_filteredCreatureData,((t,a)=>(i(),c("div",{class:"creaturesData__box",style:e.flexboxStyle,key:t.name+"#"+a,onClick:a=>e.setTag(t.tag,a)},[u("img",{src:t.critterpediaImage,alt:"Tag: "+t.name,style:e.flexboxImageStyle},null,12,["src","alt"]),u("p",z,C(e.$t(`creatures.${t.name.split("'").join("")}`)),1),u(d,{class:"add-to-list-btn",prop_itemData:t},null,8,["prop_itemData"])],12,["onClick"])))),128))]),Q])],512)),[[S,e.prop_selectedCreatureData.length>0]])}));j.render=J,j.__scopeId="data-v-d10f0364";const K=o({name:"creaturesPage",components:{SectionComponent:a,Preloader:b,CreaturesPageTabs:A,CreaturesFlexboxView:j},data:()=>({data_isLoading:!0,data_categories:[],data_selectedCategory:"",data_dataOfSelectedCategory:[],data_swipeable:!0,data_categoryMenuTitle:{text:"Select a category",value:""}}),computed:{computed_currentLocale(){return this.$i18n.locale},computed_dataIsLoading(){return this.data_isLoading},computed_creaturesCategories(){return this.$store.getters[`creaturesData/${r.GET_CREATURES_CATEGORIES}`]}},watch:{data_creaturesCategories(){}},created(){this.$store.dispatch(`creaturesData/${r.SET_CREATURES_CATEGORIES}`),this.$store.dispatch(`languageSetting/${t.SET_TRANSLATION_DATA_FOR_CREATURES}`)},beforeMount(){s.get("https://www.animal-crossing.me/api/ac/creatures/categories",{headers:{CLIENT_REQ:"Vue.js-FETCH_CREATURES_CATEGORIES"}}).then((e=>{const t=e.data;this.data_categories=t,this.data_isLoading=!1}))},mounted(){},beforeUnmount(){},methods:{getDataOfSelectedTag(e){const t=this.data_selectedCategory;if(!e)return console.log("data_selectedTag被重設"),void(this.prop_creaturesPageResults=[]);this.data_selectedTag=e;let a=`https://www.animal-crossing.me/api/ac/items/detailed-data?sourceSheet=${t}&tag=${e}`;this.axios.get(a).then((t=>{const a=t.data;console.log("getDataOfSelectedTag裡面的 this:",this),this.prop_creaturesPageResults=a,this.data_tagsMenuTitle=e}))},setClickedCategory(e){e!==this.data_selectedCategory&&(this.data_selectedCategory=e,s.get(`https://www.animal-crossing.me/api/ac/creatures?category=${e}`,{headers:{CLIENT_REQ:`fetch creatures data by category: ${e}`}}).then((e=>{const t=e.data;this.data_dataOfSelectedCategory=t})))},creatureSelected(e,t){console.log("creatureSelected: ",{creatureName:e,eventTarget:t})}}}),W=g();l("data-v-5f9d23d9");const X={class:"itemsPageContainer"};d();const Y=W(((e,t,a,r,s,o)=>{const l=n("Preloader"),d=n("CreaturesFlexboxView"),g=n("CreaturesPageTabs"),m=n("SectionComponent");return i(),c("div",X,[u(l,{prop_isLoading:e.computed_dataIsLoading},null,8,["prop_isLoading"]),e.computed_dataIsLoading?p("",!0):(i(),c(m,{key:0,class:"no-margin",props_title:"分類",props_subtitle:"Step 1. 選取分類"},{default:W((()=>[u(g,{prop_categories:e.data_categories,onCategoryClicked:e.setClickedCategory},{default:W((()=>[u(d,{prop_selectedCreatureData:e.data_dataOfSelectedCategory,onCreatureSelected:e.creatureSelected},null,8,["prop_selectedCreatureData","onCreatureSelected"])])),_:1},8,["prop_categories","onCategoryClicked"])])),_:1},8,["props_subtitle"]))])}));K.render=Y,K.__scopeId="data-v-5f9d23d9";export default K;
