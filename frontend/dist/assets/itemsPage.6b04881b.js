import{L as t,_ as e,c as a,I as s,T as o}from"./index.37cfd9ea.js";import{_ as d,a as l,b as n}from"./detailedCardContent.7fa43c68.js";import{_ as r}from"./AddToListBtn.b5210be3.js";import{m as i,J as c,K as g,M as p,L as u,D as _,e as m,E as h,F as C,V as T,G as f,I as v,s as y,v as D}from"./vendor.a945b803.js";var S=i({name:"ItemPageResults",components:{ItemCard:d,ItemCardBody:l,DetailedCardContent:n,AddToListBtn:r},setup:()=>{},props:{prop_itemPageResults:{type:Array,required:!0,default:[]},prop_selectedTag:{type:String,required:!0,default:null}},data(t){return{dataObj:null,data_cardSettingAndData:{cardTitle:"",setting:{closeOnClickOverlay:!0,showCancelBtn:!1,showLoader:!0},data:{}},data_itemName:"",data_currentLocale:this.$i18n.locale}},computed:{computed_itemPageResults(){let e=this.$store.getters[`languageSetting/${t.GET_TRANSLATION_DATA_BY_NAME}`],a=this.prop_itemPageResults,s=this.$i18n.locale,o=[];for(let t=0;t<a.length;t++){const d=e[a[t].name].translation[s],l=a[t];l.nameTranslated=d,console.log("處理過後的item:",l),o.push(l)}return o}},watch:{},created(){},mounted(){},unmounted(){},methods:{clickCardConfirmEventHandler(t){console.log("data in clickCardConfirmEventHandler: ",t),this.data_cardSettingAndData.showCard=!1},clickItemForDetail(t,e){const a=t.name;this.data_cardSettingAndData.showCard=!0,this.axios.get(`/api/ac/items/detailed-data?name=${a}`).then((t=>{const e=t.data;e.idForTranslation=null,this.data_cardSettingAndData.data=e,setTimeout((()=>{this.data_cardSettingAndData.setting.showLoader=!1}),200)}))}}});const I=v();c("data-v-13496515");const b={key:0},L=m("hr",null,null,-1),A=m("br",null,null,-1),k=m("h2",null," 目前標籤 : ",-1),x={class:"currentTag"},E=m("p",{class:"subHeading--click"}," 點擊圖片查看物品資訊 ",-1),P={id:"itemsOfSelectedTag"},M={class:"flexbox"},$={class:"itemName"},O=m("br",null,null,-1);g();const R=I(((t,e,a,s,o,d)=>{const l=p("AddToListBtn"),n=p("DetailedCardContent"),r=p("ItemCardBody"),i=p("ItemCard");return u(),_(C,null,[t.prop_selectedTag?(u(),_("div",b,[L,A,k,m("h3",x,h(t.prop_selectedTag),1),E,m("div",P,[m("div",M,[(u(!0),_(C,null,T(t.computed_itemPageResults,((e,a)=>(u(),_("div",{class:"flexbox__item",key:"#"+a+e.name,onClick:a=>t.clickItemForDetail(e,e._id)},[m("img",{src:e.variants[0].image,alt:"Tag: "+e.variants[0].tag},null,8,["src","alt"]),m("p",$,h(e.nameTranslated),1),m(l,{class:"add-to-list-btn",prop_itemData:e},null,8,["prop_itemData"])],8,["onClick"])))),128))])]),O])):f("",!0),m(i,{onCardConfirmBtnClicked:t.clickCardConfirmEventHandler,prop_cardData:t.data_cardSettingAndData},{default:I((()=>[m(r,null,{default:I((()=>[m(n,{prop_cardData:t.data_cardSettingAndData},null,8,["prop_cardData"])])),_:1})])),_:1},8,["onCardConfirmBtnClicked","prop_cardData"])],64)}));S.render=R,S.__scopeId="data-v-13496515";var w=i({name:"ItemCategories",components:{},setup:()=>{},props:{prop_selectedCategory:{type:String,required:!0,default:""},prop_tagsData:{type:Array,required:!1,default:[]}},data:t=>({}),computed:{},watch:{},created(){},mounted(){},unmounted(){},methods:{setTag(t,e){document.querySelectorAll(".tagsData__box ").forEach((t=>t.classList.remove("active"))),e.target.parentElement.classList.add("active"),this.$emit("tagSelected",t)}}});const B=v();c("data-v-bd1b0812");const F=m("hr",null,null,-1),j=m("h4",{class:"tagSectionHeading"}," Step 2. 選擇分類標籤: ",-1),H={id:"tagsData"},N={class:"tagsData__flexContainer"},q={class:"tagName"},G=m("br",null,null,-1);g();const V=B(((t,e,a,s,o,d)=>y((u(),_("div",null,[F,j,m("div",H,[m("div",N,[(u(!0),_(C,null,T(t.prop_tagsData,((e,a)=>(u(),_("div",{class:"tagsData__box",key:e.tag+"#"+a,onClick:a=>t.setTag(e.tag,a)},[m("img",{src:e.img,alt:"Tag: "+e.tag},null,8,["src","alt"]),m("p",q,h(e.tag),1)],8,["onClick"])))),128))]),G])],512)),[[D,t.prop_selectedCategory]])));w.render=V,w.__scopeId="data-v-bd1b0812";var U=i({name:"Preloader",components:{},setup:()=>{},props:{prop_isLoading:{type:Boolean,default:!0}},data:t=>({dataObj:null}),computed:{},watch:{},created(){},mounted(){},unmounted(){},methods:{}});const z=v();c("data-v-0feb0011");const J={key:0,class:"loadingContainer"},K={class:"loadingContainer__background"},Y=m("p",{class:"loadingText"},"Loading ",-1);g();const Q=z(((t,e,a,s,o,d)=>{const l=p("van-loading");return t.prop_isLoading?(u(),_("div",J,[m("div",K,[t.prop_isLoading?(u(),_(l,{key:0,class:"loader",color:"#dfdfdf",size:"48px",vertical:"",type:"spinner"},{default:z((()=>[Y])),_:1})):f("",!0)])])):f("",!0)}));U.render=Q,U.__scopeId="data-v-0feb0011";var W=i({name:"itemsPage",components:{SectionComponent:e,ItemCategories:w,AppIcon:a,Preloader:U,ItemPageResults:S},data:()=>({prop_isLoading:!0,prop_itemPageResults:[],data_currentTags:[],data_selectMenuOptions:[],data_selectedCategory:"",data_swipeable:!0,data_categoryMenuTitle:{text:"Select a category",value:""},data_tagDataIsLoading:!1,data_tagsData:[],data_tagsMenuOptions:[],data_tagsMenuTitle:{text:"Select a tag",value:null},data_selectedTag:""}),computed:{computed_allItemsCategories(){return this.$store.getters[`itemsData/${s.get_ITEM_DETAILS_CATEGORIES}`]},computed_currentLocale(){return this.$i18n.locale}},watch:{computed_allItemsCategories(){let t=this.computed_allItemsCategories,e=[],a=["Accessories","Art","Bags","Bottoms","Clothing Other","Construction","Dress-Up","Fencing","Fish","Fossils","Headwear","Insects","Music","Other","Photos","Posters","Recipes","Sea Creatures","Shoes","Socks","Tools","Tops","Umbrellas","Villagers"],s={};for(let o=0;o<a.length;o++)s[a[o]]=a[o];for(let o=0;o<t.length;o++){if(s[t[o]])continue;let a={text:this.$t(`items.category.${t[o].toLowerCase()}`),value:t[o]};e.push(a)}e.unshift({text:"Select a category",value:""}),this.data_selectMenuOptions=e,this.prop_isLoading=!1},data_selectedCategory(){const t=this.data_selectedCategory;if(!t)return console.log("selectedCategory被reset"),this.data_categoryMenuTitle={text:"Select a category",value:""},this.data_tagsMenuTitle={text:"Select a tag",value:""},this.data_tagsMenuOptions=[],void(this.data_selectedTag="");if(t){console.log("選取的 category: ",t),o.loading({message:"讀取中",forbidClick:!0}),this.data_categoryMenuTitle.text=`目前分類: ${this.data_selectedCategory}`,this.data_tagDataIsLoading=!0;let e=`/api/ac/items/detailed-data/categories/tags/first-doc?category=${t}`;this.axios.get(e).then((t=>{o.success("資料更新成功");const e=t.data,a=[];for(let s=0;s<e.length;s++){const t={tag:e[s]._id||null,img:e[s].image||e[s]["image-storage"]};a.push(t)}this.data_selectedTag="",this.data_tagsData=a,this.data_tagDataIsLoading=!1}))}},computed_currentLocale(){this.$store.dispatch(`itemsData/${s.SET_ITEM_DETAILS_CATEGORIES}`)}},beforeMount(){this.$store.dispatch(`itemsData/${s.SET_ITEM_DETAILS_CATEGORIES}`)},mounted(){},beforeUnmount(){},methods:{getDataOfSelectedTag(t){const e=this.data_selectedCategory;if(!t)return console.log("data_selectedTag被重設"),void(this.prop_itemPageResults=[]);this.data_selectedTag=t;let a=`/api/ac/items/detailed-data?sourceSheet=${e}&tag=${t}`;this.axios.get(a).then((e=>{const a=e.data;this.prop_itemPageResults=a,this.data_tagsMenuTitle=t}))}}});const X=v();c("data-v-38036dba");const Z={class:"itemsPageContainer"};g();const tt=X(((t,e,a,s,o,d)=>{const l=p("Preloader"),n=p("van-dropdown-item"),r=p("van-dropdown-menu"),i=p("ItemCategories"),c=p("ItemPageResults"),g=p("SectionComponent");return u(),_("div",Z,[m(l,{prop_isLoading:t.prop_isLoading},null,8,["prop_isLoading"]),t.prop_isLoading?f("",!0):(u(),_(g,{key:0,class:"no-margin",props_title:"物品分類",props_subtitle:"Step 1. 使用選單選取分類"},{default:X((()=>[m(r,{overlay:!1},{default:X((()=>[m(n,{title:t.data_categoryMenuTitle.text,modelValue:t.data_selectedCategory,"onUpdate:modelValue":e[1]||(e[1]=e=>t.data_selectedCategory=e),options:t.data_selectMenuOptions},null,8,["title","modelValue","options"])])),_:1}),m(i,{prop_selectedCategory:t.data_selectedCategory,prop_tagsData:t.data_tagsData,onTagSelected:t.getDataOfSelectedTag},null,8,["prop_selectedCategory","prop_tagsData","onTagSelected"]),m(c,{prop_itemPageResults:t.prop_itemPageResults,prop_selectedTag:t.data_selectedTag},null,8,["prop_itemPageResults","prop_selectedTag"])])),_:1},8,["props_subtitle"]))])}));W.render=tt,W.__scopeId="data-v-38036dba";export default W;
